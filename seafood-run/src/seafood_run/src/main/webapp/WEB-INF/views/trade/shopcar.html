<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

<title>我的购物车 - Powered by $!{sysconfig.siteName}</title>
<meta name="keywords" content=""/>
<meta name="description" content=""/>
<meta name="generator" content=""/>
<meta name="author" content=""/>
<meta name="copyright" content=""/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<link href="/static/home/shopmanage/css/public.css" type="text/css" rel="stylesheet" />
<link href="/static/home/shopmanage/css/goods.css" type="text/css" rel="stylesheet" />
<link href="/static/home/shopmanage/css/overlay.css" type="text/css" rel="stylesheet" />
<link href="/static/home/shopmanage/css/public_auto.css" type="text/css" rel="stylesheet" />
<script src="/static/home/shopmanage/js/jquery-1.6.2.js"></script>
<script src="/static/home/shopmanage/js/jquery-ui-1.8.21.js"></script>
<script src="/static/home/shopmanage/js/jquery.shop.common.js"></script>
<script src="/static/home/shopmanage/js/jquery.validate.min.js"></script>
<script src="/static/home/shopmanage/js/jquery.SuperSlide.2.1.1.js"></script>
<script src="/static/home/shopmanage/js/jquery.lazyload.js"></script>
<style type="text/css">
.goodscar { display:none; }
.top_user { position:absolute; right:0px }
.head_search { width:610px; }
.head_seartxt .h_sear_txt { width:500px; }
</style>
</head>
<body>
#parse("/common/top.html")
#parse("/common/left.html")
<div class="main">
  <div class="shopping_cart">
    <div class="shopping_step" style="float:none;">
      <ul>
        <li class="shopping_step_athis"><span></span><i></i><strong>1.我的购物车</strong></li>
        <li class="shopping_step_b"><span></span><i></i><strong>2.填写核对订单信息</strong></li>
        <li class="shopping_step_c"><span></span><i></i><strong>3.成功提交订单</strong></li>
      </ul>
    </div>
    <div class="">
    <div id="shoppingcart" class="">
<style>
.cart_common{ margin-left:57px;}
</style>
<div id="carts_list">   <form method="post" name="cart_form" target="_self" id="cart_form" action="/shopTrade.java?cmd=confirmOrder">
    <input type="hidden" name="proIdNums" id="proIdNums" value=""/>
    <input type="hidden" name="tjfs" id="tjfs" value="cart"/>
    <input type="hidden" name="ccId" id="ccId" value=""/>
    <div class="shopping_list">
      <div class="shopping_h">
        <h1 style="font-size:16px;">我的购物车</h1>
        <span class="hbuy_l" style="font-size:14px"></span> </div>
      <table width="1200" border="0" cellpadding="0" cellspacing="0" class="shopping_table">
        <tbody><tr>
          <th align="left"> <span class="shopping_table_check">
            <label>
              <input name="ids" type="checkbox" value="-1" id="ids">
              全选</label>
            </span></th>
          <th width="33%">商品名称</th>
          <th width="12%">规格</th>
          <th width="13%">单价</th>
          <th width="8%">数量</th>
          <th width="13%">小计(元)</th>
          <th>操作</th>
        </tr>
                <!--普通商品开始-->
    #foreach($obj in $carPros)                            
   <tr goods_list="goods_info_$!{obj.get("pro").id}" id="goods_info_$!{obj.get("pro").id}"> 
     <td><span class="shopping_table_check1"> <input name="id" type="checkbox" mark="" value="$!{obj.get("pro").id}" id="id" ccId="$!obj.id"/> </span></td> 
     <td>
      <dl class="shopping_goods"> 
       <dt>
        <a href="/goShop.java?cmd=productDetail&id=$!{obj.get("pro").id}" target="_blank"><span class="img_cspan"> <p><img src='$!{obj.get("pro").imgPaths.split("_")[0]}' width="60" height="60" /></p> </span></a>
       </dt> 
       <dd> 
        <h5><a href="/goShop.java?cmd=productDetail&id=$!{obj.get("pro").id}" target="_blank">$!{obj.get("pro").name} </a> </h5> 
       </dd> 
      </dl></td>
     <td align="center">
      <div class="standard_td">
       颜色：黑色
       <br />
       <!--规格修改--> 
       <div class="standard" id="standard_192" style="display:none"> 
        <div class="standard_left"></div> 
        <div class="standard_right">
         <img src="" width="150" height="150" />
        </div> 
       </div> 
       <!--规格修改--> 
       <b style="display: none;"><a href="javascript:void(0);" obj_img='$!{obj.get("pro").imgPaths.split("_")[0]}' obj_id="192" onclick="change_spec(this);">修改</a></b> 
      </div></td> 
     <td align="center">&yen;$!{obj.amt}
     <input type="hidden" id="pro_amt_$!{obj.get("pro").id}" value="$!{obj.get("pro").amt}"/>
     </td> 
     <td><span class="shop_count"> <a href="javascript:void(0);" id="count_down_$!{obj.get("pro").id}" gc_id="$!{obj.get("pro").id}" f_sale_type="0" class="shop_cut"></a> <input name="goods_count_$!{obj.get("pro").id}" type="text" id="goods_count_$!{obj.get("pro").id}" f_sale_type="0" value="$!{obj.get("num")}" gc_id="$!{obj.get("pro").id}" goods_count="1" class="shop_num" /> <a href="javascript:void(0);" id="count_up_$!{obj.get("pro").id}" pc_inventory="$!{obj.get("pro").inventory}" gc_id="$!{obj.get("pro").id}" f_sale_type="0" class="shop_add"></a> </span></td> 
     <td align="center"><input id="gc_price_$!{obj.get("pro").id}" type="text" value="￥$!{obj.get("pro").amt}" class="shopping_result" style="font-size:16px;width:80px;border:0px;background-color:white;"disabled/></td> 
     <td align="center"><a href="javascript:void(0);" user_id="" id="favorite_114" class="cart_common" data-value="$!{obj.get("pro").id}">收藏</a><a href="javascript:void(0);" onclick="big_cart_remove('$!{obj.get("pro").id}','$!{obj.get("spec").id}');" class="cart_common">删除</a></td> 
    </tr>
    #end
      </tbody></table>
    </div>
    <div id="show_money">
    <div class="shopping_operate over_buy_button" id="shopping_operate" style="height: 50px; width: 1200px;"> <span class="go_count"> <i style="height:45px; width:200px; float:left;">
      </i> <b>商品总价（不含运费）：<strong id="total_price">¥0.00</strong>元</b>
      #if($user)
      <a href="javascript:void(0);" onclick="confirm_cart()" class="go_price" style="cursor: url(/shopTrade.java?cmd=confirmOrder), auto; background: rgb(255, 0, 0);">
      #else
      <a href="javascript:void(0);" dialog_uri='/shopMemberCenter.java?cmd=toLogin2&rUrl=${tu.urlenCode("/goShop.java?cmd=toShopCar")}' dialog_title="会员登录" dialog_width="430" dialog_height="100" dialog_id="user_login" class="go_price" style="background: rgb(153, 153, 153);">
      #end
      <input type="hidden" name="gcs" id="gcs">
      去结算</a></span> <span class="shopping_operate_check">
      <label>
        <input name="ids" type="checkbox" value="-1" id="ids">
        全选</label>
      </span><span class="shop_del_all"><a href="javascript:void(0);" onclick="more_big_cart_remove();">批量删除</a></span><span class="shop_del_all"><a href="/goShop.java">继续购物</a></span></div>
     </div> 
  </form>
    <div class="shopping_car_none" style="display:none">
    <div class="shopcar_none_box">
      <dl>
        <dt></dt>
        <dd>
          <h4>您的购物车还是空的，赶紧行动吧！</h4>
          <span class="none_box_sp">您可以<a href="/buyer/order.htm">查看订单</a>，或者是<a href="/index.htm">随便看看</a></span></dd>
      </dl>
    </div>
  </div>
</div>

<div class="shopping_other">
  <div class="shopping_other_list_center">
    <div class="shopping_other_list_button">
      <div class="shopping_other_list_button_left">您可能还需要其他商品</div>
      <div class="shopping_other_list_button_right"> <a class="next"></a>
        <ul><li class="on">1</li></ul>
        <a class="prev"></a> </div>
    </div>
    <div class="shopping_other_list_center_box">
      <div class="shopping_other_list_center_box_c">
        <ul>
                           #foreach($obj in $ynides.result)            	 
                              <li><span><a href="/goShop.java?cmd=productDetail&id=$!obj.id" target="_blank"><img src='$!{obj.imgPaths.split("_")[0]}'></a></span><i><a href="/goShop.java?cmd=productDetail&id=$!{obj.get("pro").id}" target="_blank">$!{obj.name}</a></i><b>商城价：<strong>¥$!{obj.amt}</strong></b> <em class="shopping_other_list_center_box_buy"><a style="margin:0 auto;" href="javascript:void(0);" goods_id="$!{obj.get("pro").id}" goods_type="0" user_id="" id="goods_cart_$!{obj.get("pro").id}" onclick="big_car_add('$!{obj.get("pro").id}');">加入购物车</a>              </em> </li>
                           #end
                  </ul>
      </div>
    </div>
  </div>
</div>
</div>
    </div>
    </div>
  ﻿<script>
jQuery(document).ready(function(){
			//滚动条滚动事件
	jQuery(window).scroll(function(){
	var top = jQuery(document).scrollTop();
	if(top==0){
		  jQuery("#back_box").hide();
		  jQuery(".back_box_x").hide();
		}else{
		  jQuery("#back_box").show();	
	      jQuery(".back_box_x").show();
		}
	});	
	//
	jQuery("#toTop").click(function(){
       jQuery('body,html').animate({scrollTop:0},1000);
       return false;
    });
});
</script>
#parse("/common/footer.html")
<!--返回最顶部-->
<div id="back_box" style="position: fixed; width: 40px; height: 118px; float: left; right: 0px; bottom: 150px;">
  <div class="back_index"><a href="/index.htm" target="_blank" title="返回主页"></a></div>
  <div class="back_top"><a id="toTop" href="/goods_cart1.htm#" bosszone="hometop" style="display: block;" title="返回顶部" target="_self"></a></div>
</div>
 
 </div> 

<script>
  function goods_count_adjust(){
	  var proIdNums="",allPrize=0;
	  var ccId="";
	  jQuery(":checkbox[id=id][checked=true]").each(function(){
		   var id=jQuery(this).val();
		   var num = jQuery("#goods_count_"+id).val();
		   var prize = jQuery("#pro_amt_"+id).val();
		   allPrize+=prize*num;
		   proIdNums+=(id+"_"+num)+","
		   ccId+=jQuery(this).attr("ccId")+",";
	  });
	  jQuery("#ccId").val(ccId);
	  allPrize = allPrize.toFixed(2)
	  jQuery("#total_price").html("¥"+allPrize);
	  jQuery("#proIdNums").val(proIdNums);
  }

  function confirm_cart(){
	  var carPros = "$!carPros.size()";
	  if(carPros >= 1){
		  if(jQuery("#proIdNums").val() != ""){
		  	jQuery("#cart_form").submit();
		  }else{
			  showDialog("msg_info", "", "请选择下单商品！",2,"succeed",3,'');	  
		  }
	  }else{
		showDialog("msg_info", "", "当前购物车为空，请去商品页选购商品！",2,"succeed",3,'');
	  }	  
  }  
jQuery(document).ready(function(){
	//收藏
	jQuery("a[id^=favorite_]").click(function(){
		var proId = $(this).attr("data-value");
		jQuery.post("/goShop.java?cmd=collectPro",{"id":proId},function(data){
			 if(data==0){
				 showDialog("msg_info","","商品收藏成功！",2,"succeed",3,'');
				 count = count + 1; 
				 jQuery(".collect_product a").html("<i></i>收藏商品("+count+")")
			 }
			 if(data==1){
			   showDialog("msg_info","","已经收藏该商品！",2,"warning",3,'');
			 }
		  },"text");
     
		/* if(confirm("登录后才可收藏商品，现在登录？"))
     		window.location.href="/user/login.htm?url=/goods_cart1.htm" */
    });								
								
//								
  jQuery("a[id^=count_down]").click(function(){
	var gc_id=jQuery(this).attr("gc_id");
	var pro_amt =jQuery("#pro_amt_"+gc_id).val();
	var count=jQuery("#goods_count_"+gc_id).val();
	if(count>1){
	    count--;
	    jQuery("#goods_count_"+gc_id).val(count);
	    jQuery("#gc_price_"+gc_id).val("￥"+(count * pro_amt).toFixed(2));
        goods_count_adjust();
	}
  });
  jQuery("a[id^=count_up]").click(function(){
	var gc_id=jQuery(this).attr("gc_id");
	var pc_inventory = jQuery(this).attr("pc_inventory");
	var count=jQuery("#goods_count_"+gc_id).val();
	var pro_amt =jQuery("#pro_amt_"+gc_id).val();
	if(Number(count)<Number(pc_inventory)){
		count++;
	    jQuery("#goods_count_"+gc_id).val(count);
	    jQuery("#gc_price_"+gc_id).val("￥"+(count * pro_amt).toFixed(2));
	    goods_count_adjust();
	}
  });
  jQuery("input[id^=goods_count_]").keyup(function(){
	var gc_id=jQuery(this).attr("gc_id");	
	var count=jQuery("#goods_count_"+gc_id).val().replace(/\D/g,'');
	if(count==""){
       count=1;
	}	
	if(count>0){
		goods_count_adjust();
	}
	if(count==0){
		jQuery("#goods_count_"+gc_id).val("1");
		goods_count_adjust();
	}
  });
  //
  jQuery(":checkbox[id=id]").click(function(){
	var carts_size = jQuery(":checkbox[id=id][checked=true]").length;
	    if(carts_size<=0){
		 jQuery("span.go_count a").css("background","#999");
		}else{
		  jQuery("span.go_count a").css("background","#F00");
	     }										
     var val=jQuery(this).attr("checked");
	 if(val=="checked"){
        jQuery(this).parent().parent().parent().addClass("this");
		var gc_id=jQuery(this).val();
		goods_count_adjust();
	 }else{
	    jQuery(this).parent().parent().parent().removeClass("this");
		var gc_id=jQuery(":checkbox[id=id][checked=true]:first").val();
	    goods_count_adjust();
	 }
  });
  //
  jQuery(":checkbox[id=ids]").click(function(){
    var val=jQuery(this).attr("checked");
	var value = jQuery(this).val();
	if(val=="checked"){
	  jQuery(":checkbox[id=id]").attr("checked","checked");
	  jQuery(":checkbox[value="+value+"]").attr("checked","checked");
	  jQuery(".shopping_table tr").addClass("this");
	  goods_count_adjust();
	}else{
      jQuery(":checkbox[id=id]").attr("checked",false);
	  jQuery(":checkbox[value="+value+"]").attr("checked",false);
	  jQuery(".shopping_table tr").removeClass("this");
	  goods_count_adjust();
	}
	var carts_size = jQuery(":checkbox[id=id][checked=true]").length;
	    if(carts_size<=0){
		 jQuery("span.go_count a").css("background","#999");
		}else{
		  jQuery("span.go_count a").css("background","#F00");
	   }
  });
  //打开页面清除所有商品选择
  jQuery(":checkbox").attr("checked",false);
  jQuery("span.go_count a").css("background","#999");  
      jQuery("div[id^=gift_inner_]").find("input").each(function(){                                           
       jQuery(this).click(function(){  
        var test= jQuery(this).attr("checked");    
        if(this.checked){  
         jQuery(this).parent().parent().parent().siblings().removeClass("this").find("input").attr("checked",false);  
		 jQuery(this).parent().parent().parent().addClass("this");
        }     
       });  
      });  
   jQuery(".standard_td").hover(function(){
		jQuery(this).find("b").show();								 
		},function(){
			jQuery(this).find("b").hide();		
			});
//去结算横条浮动   
jQuery(window).scroll(function(){
        var holder = jQuery("#shopping_operate"),
            elHeight = holder.height(),
            elWidth = holder.width(),
            oTop = holder.offset().top;
        function scrollBar() {
    		var dTop = jQuery(document).scrollTop(),
    			wHeight = jQuery(window).height();
    		if (dTop < (oTop - wHeight + elHeight)) {
    			holder.css({
    				height: elHeight,
    				width: elWidth
    			}).addClass('over_buy_button');
    		} else {
    			holder.removeClass('over_buy_button');
    		}
    	}
        scrollBar();
    	jQuery(window).unbind('scroll').bind('scroll', scrollBar);   
	});

});////
function more_big_cart_remove(){
	  	  var gcs="";
		  jQuery(":checkbox[id=id][checked=true]").each(function(){
			   var id=jQuery(this).val();
			  gcs+=id;
			   var shopCar = jQuery.cookie("discoshopCar");
				var shopCarNew="";
				if(shopCar){
					var shopCarIds = shopCar.split(",");
					for(var i=0;i<shopCarIds.length;i++){
						if(shopCarIds[i]!=id){
							shopCarNew+=shopCarIds[i]+","
						}
					}
					shopCarNew = shopCarNew.substr(0,(shopCarNew.length-1))
					jQuery.cookie("discoshopCar",shopCarNew,{expires:10,path:"/"});
					jQuery("#goods_info_"+id).remove();
				}
		 	 });
			if(gcs!=""){
				window.location.href="goShop.java?cmd=toShopCar";
			}else{
			  showDialog("warning","","至少选中一条数据！",2,"warning",3,'');		
			}	  
	}
	
function big_cart_remove(id,spec){
	spec=spec==''?'0':spec;
	jQuery.ajax({type:'POST',url:'/goShop.java?cmd=deleteShopCar',data:{"id":id,num:1,spec:spec},
		  success:function(data){
			  window.location.href="goShop.java?cmd=toShopCar";
		  }
	});
}
function big_car_add(id){
	var shopCar = jQuery.cookie("discoshopCar");
	  if(!shopCar){
		  shopCar = id;
	  }else{
		  if(shopCar.split(",").indexOf(id)==-1){
		  	shopCar+=","+id
		  }
	  }
	jQuery.cookie("discoshopCar",shopCar,{expires:10,path:"/"});
	window.location.href="goShop.java?cmd=toShopCar";
}
function change_spec(obj){
	var obj_id = jQuery(obj).attr("obj_id");
	var div =jQuery("#standard_"+obj_id);
		jQuery("div[id^=standard_]").hide();
		var obj_img = jQuery(obj).attr("obj_img");
		jQuery.post("/goods_cart1_spec.htm",{
			"cart_id":obj_id
			},function(data){
				jQuery(div).find(".standard_left").html(data);
				jQuery(div).show().find(".standard_right img").attr("src",obj_img);
				},"text");
	}
function confirm_change_spec(obj){
	var id = jQuery(obj).attr("cart_id");
	var gsp="";
	jQuery(".product_choose_standard").find("#pro_choose_li_standard_"+id).each(function(){
			 jQuery(jQuery(this).find("a[class='choose_notype_standard this']")).each(function(){								 
				 gsp=jQuery(this).attr("gsp")+","+gsp; 
			 });
			 jQuery(jQuery(this).find("a[class='choose_one_standard this']")).each(function(){								 
				 gsp=jQuery(this).attr("gsp")+","+gsp; 
			 });
		});
	jQuery.post("/goods_cart1_spec_save.htm",{
			"id":id,
			"gsp":gsp
			},function(data){
				if(data.code==100){
					 lazyload();
					}else{
					showDialog("error","","未知错误，请刷新页面重试",1,"error",3);
						}
				},"json");
	}	
function cancle_change(){
	jQuery("div[id^=standard_]").hide();
}
function tosubmit(){
	
}
</script>
</body></html>