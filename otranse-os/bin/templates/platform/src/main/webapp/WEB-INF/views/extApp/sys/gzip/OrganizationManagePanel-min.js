if(typeof Global==="undefined"){Global={}}Global.organizationLoader=new Disco.Ext.MemoryTreeLoader({iconCls:"disco-tree-node-icon",varName:"Global.ORG_LOADER_NODES",url:"organization.java?cmd=getTree&pageSize=-1&treeData=true&all=false",listeners:{beforeload:function(b,a){b.baseParams.id=(a.id.indexOf("root")<0?a.id:"");if(typeof a.attributes.checked!=="undefined"){b.baseParams.checked=false}}}});OrganizationListPanel=Ext.extend(Disco.Ext.CrudPanel,{id:"organizationListPanel",baseUrl:"organization.java",viewWin:{width:430,height:310,title:"\u7f01\u52ed\u7c90\u93c8\u70d8\u702f\u6dc7\u2103\u4f05"},orgTypeFormat:function(a){if(a===1){return"\u95ae\u3129\u68ec"}else{if(a===2){return"\u93c0\ue21d\ue511"}else{return"\u93c8\ue046\u7161\u93c8\u70d8\u702f"}}},onCreate:function(){},createForm:function(){var a=new Ext.form.FormPanel({frame:true,labelWidth:70,labelAlign:"right",defaultType:"textfield",defaults:{anchor:"-20"},items:[{xtype:"hidden",name:"id"},Disco.Ext.Util.twoColumnPanelBuild({fieldLabel:"\u93c8\u70d8\u702f\u942e\u4f78\u5f7f",name:"sn",allowBlank:false},{fieldLabel:"\u93c8\u70d8\u702f\u935a\u5d87\u041e",name:"title",allowBlank:false},{fieldLabel:"\u9366\u677f\u6f43",name:"address"},{name:"principal",fieldLabel:"\u7490\u71bb\u77d7\u6d5c\ufffd"},{fieldLabel:"\u9422\u4f43\u763d",name:"tel"},{fieldLabel:"\u95ad\ue1be\u7d2a",name:"postal"},{fieldLabel:"\u6d7c\u72b5\u6e61",name:"fax"},{fieldLabel:"\u95ad\ue1be\ue188",name:"email"},{fieldLabel:"\u7f03\u621d\u6f43",name:"url"},{name:"sequence",fieldLabel:"\u93ba\u6391\u7c2d\u9359\ufffd",xtype:"numberfield"},{name:"orgType",allowBlank:false,xtype:"radiogroup",fieldLabel:"\u93c8\u70d8\u702f\u7eeb\u8bf2\u7037",items:[{xtype:"radio",boxLabel:"\u95ae\u3129\u68ec",inputValue:1,name:"orgType",checked:true},{xtype:"radio",boxLabel:"\u93c0\ue21d\ue511",inputValue:2,name:"orgType"}]}),{name:"intro",fieldLabel:"\u9471\u5c83\u5158\u6d60\u5b2c\u7c9b",xtype:"textarea"},{fieldLabel:"\u95c4\u52ec\u655e",xtype:"textarea",name:"annotation"}]});return a},reloadTree:function(){if(this.tree){Global.organizationLoader.remoteObject.clearData();this.tree.root.reload()}if(this.fp){var a=this.fp.form.findField("parent");if(a&&a.tree.rendered){a.tree.root.reload()}}},createWin:function(b,a){return this.initWin(650,400,"\u9352\u55da\ue511\u6d93\u5b2c\u6b91\u7f01\u52ed\u7c90\u93c8\u70d8\u702f\u6dc7\u2103\u4f05\u8930\u66de\u53c6",b,a)},storeMapping:["id","sn","title","parent","principal","address","intro","dirPath","tel","fax","sequence","postal","email","url","annotation","orgType"],initComponent:function(){this.cm=new Ext.grid.ColumnModel([{header:"\u7f02\u6827\u5f7f",sortable:true,width:100,dataIndex:"sn"},{header:"\u935a\u5d87\u041e",sortable:true,width:100,dataIndex:"title"},{header:"\u9422\u4f43\u763d",sortable:true,width:100,dataIndex:"tel"},{header:"\u93c8\u70d8\u702f\u7eeb\u8bf2\u7037",sortable:true,width:100,align:"center",dataIndex:"orgType",renderer:this.orgTypeFormat},{header:"\u93ba\u6391\u7c2d",sortable:true,width:100,dataIndex:"sequence"},{header:"\u7ee0\ufffd\u6d60\ufffd",sortable:true,width:300,dataIndex:"intro"}]);OrganizationListPanel.superclass.initComponent.call(this);this.on("removeobject",this.reloadTree,this);this.on("saveobject",this.reloadTree,this)},listeners:{render:function(a){}}});OrganizationManagePanel=Ext.extendX(Disco.Ext.TreeCascadePanel,function(a){return{initComponent:function(){OrganizationManagePanel.superclass.initComponent.call(this);this.tree.on({scope:this,render:this.onTreeRender})},onTreeRender:function(b){},queryParam:"parentId",treeCfg:{autoScroll:true,title:"\u7f01\u52ed\u7c90\u93c8\u70d8\u702f\u93cd\ufffd",rootText:"\u6d93\u5a43\u6363\u9352\u55da\ue511",rootIconCls:"treeroot-icon",loader:Global.organizationLoader},onTreeClick:function(b){var c=(b.id!="root"?b.id:"");this.panel.parent={id:c,title:b.text};this.list.store.baseParams.parent=c;a.onTreeClick.apply(this,arguments)},getPanel:function(){if(!this.panel){this.panel=new OrganizationListPanel();this.panel.tree=this.tree;this.list=this.panel.grid}return this.panel}}});
