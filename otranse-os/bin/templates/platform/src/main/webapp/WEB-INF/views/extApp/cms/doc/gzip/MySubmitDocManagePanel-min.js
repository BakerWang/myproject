if(typeof Global==="undefined"){Global={}}if(!Global.mySendDocOrgDirLoader){Global.mySendDocOrgDirLoader=new Disco.Ext.MemoryTreeLoader({iconCls:"disco-tree-node-icon",varName:"Global.MY_SEND_DOC_ORG_LOADER",url:"newsDir.java?cmd=getDirTreeByCurrentUserOrg&pageSize=-1&treeData=true&all=false&orgdir=true",listeners:{beforeload:function(b,a){b.baseParams.id=(a.id.indexOf("root")<0?a.id:"");if(typeof a.attributes.checked!=="undefined"){b.baseParams.checked=false}}}})}if(!Global.mySendDocBranchDirLoader){Global.mySendDocBranchDirLoader=new Disco.Ext.MemoryTreeLoader({iconCls:"disco-tree-node-icon",varName:"Global.MY_SEND_DOC_BRANCH_DIR_LOADER",url:"newsDir.java?cmd=getBranchDirTree&pageSize=-1&treeData=true&all=false&orgType=null",listeners:{beforeload:function(b,a){b.baseParams.id=(a.id.indexOf("root")<0?a.id:"");if(typeof a.attributes.checked!=="undefined"){b.baseParams.checked=false}}}})}MySubmitDocManagePanel=Ext.extend(Disco.Ext.CrudPanel,{gridSelModel:"checkbox",id:"mySubmitDocManagePanel",baseUrl:"newsDoc.java",autoLoadGridData:true,autoScroll:false,totalPhoto:0,pageSize:20,showAdd:false,batchRemoveMode:true,gridViewConfig:{forceFit:true,enableRowBody:true,showPreview:true},tempCookie:{dir:null},edit:function(){var a=this;if(!this.editWin){Disco.Ext.Util.listObject("NewsDocEditManagePanel",function(b){this.editWin=b;this.editWin.show();this.editWin.refurbishParentGrid=function(){a.grid.store.reload()};this.initWinFormData(this.editWin)}.createDelegate(this),"cms/doc/NewsDocEditManagePanel.js")}else{this.editWin.show();this.initWinFormData(this.editWin)}},initWinFormData:function(f){var a=this.grid.getSelectionModel().getSelected();if(!a){return Ext.Msg.alert("\u93bb\u6130\u554b","\u7487\u70fd\ufffd\u590b\u5ae8\u95c7\ufffd\u7f02\u682c\u7deb\u9428\u52ec\u669f\u93b9\ufffd")}Ext.Ajax.request({scope:this,url:this.baseUrl+"?cmd=getContent&id="+a.get("id"),success:function(g){var h=Ext.decode(g.responseText);h!=null||(h="");f.editor.html(h);f.editor.sync()}});var e=a.get("dir");var d=f.fp.form.findField("dir");if(e){e.title||(e.title=e.name);d.setOriginalValue(e)}var b=a.get("branchDir");var c=f.fp.form.findField("branchDir");if(b){b.title||(b.title=b.name);c.setOriginalValue(b)}f.fp.form.loadRecord(a)},view:function(){var a=this.grid.getSelectionModel().getSelected();if(!a){return Ext.Msg.alert("$!{lang.get('Prompt')}","$!{lang.get('Select first')}")}window.open("news.java?cmd=show&id="+a.get("id"))},topicRender:function(b,c,a){return String.format('{1}<b><a style="color:green" href="news.java?cmd=show&id={0}" target="_blank">&nbsp\u93cc\u30e7\u6e45</a></b><br/>',a.id,b)},stateRender:function(a){if(a==3){return"\u93bb\u612a\u6c26\u5bf0\u546d\ue178\u93cd\ufffd"}else{if(a==null||a==1){return"\u5bb8\u63d2\u5f42\u752f\ufffd"}else{return"\u93c8\ue046\u7161\u9418\u8235\ufffd\ufffd"}}},toggleDetails:function(b,c){var a=this.grid.getView();a.showPreview=c;a.refresh()},storeMapping:["id","title","keywords","iconPath","createDate","author","source","putDate","dir","toBranch","branchDir","state","branchState",{name:"branchDirId",mapping:"branchDir"},{name:"dirId",mapping:"dir"}],initComponent:function(){this.cm=new Ext.grid.ColumnModel([{header:"\u6d93\u5a5a\ue57d",dataIndex:"title",width:200,renderer:this.topicRender},{header:"\u93cd\u5fd5\u6d30",sortable:true,width:70,dataIndex:"dir",renderer:this.objectRender("name")},{width:70,sortable:true,header:"\u9359\u621d\u7af7\u9352\u677f\u578e\u741b\ufffd",dataIndex:"toBranch",renderer:this.booleanRender},{width:70,sortable:true,header:"\u9352\u55da\ue511\u93cd\u5fd5\u6d30",dataIndex:"branchDir",renderer:this.objectRender("name")},{header:"\u6d63\u6ec6\ufffd\ufffd",sortable:true,width:50,dataIndex:"author"},{header:"\u93be\u626e\u01f9\u93c3\u30e6\u6e61",sortable:true,width:90,dataIndex:"createDate",renderer:this.dateRender()},{width:60,sortable:true,header:"\u5a34\u4f7a\u25bc\u9418\u8235\ufffd\ufffd",dataIndex:"state",renderer:this.stateRender}]);var a=Global.getCurrentUser;if(a.branchAdmin){this.cm.setHidden(1,true)}MySubmitDocManagePanel.superclass.initComponent.call(this)}});
