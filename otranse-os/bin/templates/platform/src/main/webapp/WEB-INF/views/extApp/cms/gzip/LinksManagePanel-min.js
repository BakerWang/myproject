Global.organizationLoader=new Disco.Ext.MemoryTreeLoader({iconCls:"disco-tree-node-icon",varName:"Global.ORG_LOADER_NODES",url:"organization.java?cmd=getTree&pageSize=-1&treeData=true&all=false",listeners:{beforeload:function(b,a){b.baseParams.id=(a.id.indexOf("root")<0?a.id:"");if(typeof a.attributes.checked!=="undefined"){b.baseParams.checked=false}}}});LinksManagePanel=Ext.extend(Disco.Ext.CrudPanel,{id:"linksManagePanel",baseUrl:"linksManage.java",gridSelModel:"checkbox",batchRemoveMode:true,pageSize:20,edit:function(){var d=LinksManagePanel.superclass.edit.call(this);if(d){var a=this.grid.getSelectionModel().getSelected();var c=a.get("org");var b=this.fp.form.findField("deptId");if(c){c.title||(c.title=b.deptId);b.setOriginalValue(c)}}},ascription:[["\u95ae\u3129\u68ec","0"],["\u93c0\ue21d\ue511","1"],["\u6434\u65c2\u6564\u7eef\u8364\u7cba\u6769\u70b4\u5e34","2"]],ascriptionFormat:function(a){if(a==0){return"\u95ae\u3129\u68ec"}else{if(a==1){return"\u93c0\ue21d\ue511"}else{if(a==2){return"\u6434\u65c2\u6564\u7eef\u8364\u7cba\u6769\u70b4\u5e34"}}}},createForm:function(){var a=new Ext.form.FormPanel({frame:true,labelWidth:80,labelAlign:"right",defaults:{width:320,xtype:"textfield"},items:[{xtype:"hidden",name:"id"},{fieldLabel:"\u935a\u5d87\u041e",name:"name",emptyText:"\u935a\u5d87\u041e\u6d93\u5d88\u5158\u6d93\u8679\u2516",allowBlank:false,blankText:"\u935a\u5d87\u041e\u6d93\u5d88\u5158\u6d93\u8679\u2516"},{fieldLabel:"\u7f03\u621d\u6f43",name:"linkUrl"},{xtype:"numberfield",fieldLabel:"\u93ba\u6391\u7c2d",name:"sort"},{xtype:"combo",name:"ascription",hiddenName:"ascription",fieldLabel:"\u8930\u6391\u7758",displayField:"title",valueField:"value",store:new Ext.data.SimpleStore({fields:["title","value"],data:this.ascription}),editable:false,mode:"local",triggerAction:"all",emptyText:"\u7487\u70fd\ufffd\u590b\u5ae8..."},{fieldLabel:"\u95ae\u3129\u68ec",name:"deptId",xtype:"treecombo",hiddenName:"deptId",displayField:"title",valueField:"id",emptyText:"\u7487\u70fd\ufffd\u590b\u5ae8...",tree:new Ext.tree.TreePanel({autoScroll:true,root:new Ext.tree.AsyncTreeNode({id:"root",text:"\u6d93\u5a43\u6363\u9352\u55da\ue511",expanded:true,iconCls:"treeroot-icon",loader:Global.organizationLoader})})},{xtype:"textarea",fieldLabel:"\u7ee0\ufffd\u6d60\ufffd",name:"intro",height:50}]});return a},userRender:function(a){return a?a.trueName:"$!{lang.get('Unknown')}"},createWin:function(){return this.initWin(448,400,"\u8e47\ue0a3\u5d4e\u95be\u70ac\u5e34\u7ee0\uff04\u608a")},storeMapping:["id","name","linkUrl","intro","ascription","sort","org"],initComponent:function(){this.cm=new Ext.grid.ColumnModel([{header:"\u935a\u5d87\u041e",sortable:true,width:100,dataIndex:"name"},{header:"URL\u9366\u677f\u6f43",sortable:true,width:100,dataIndex:"linkUrl"},{header:"\u8930\u6391\u7758",sortable:true,width:100,dataIndex:"ascription",renderer:this.ascriptionFormat},{header:"\u93ba\u6391\u7c2d",sortable:true,width:100,dataIndex:"sort"}]);LinksManagePanel.superclass.initComponent.call(this)}});
